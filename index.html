<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"
    />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="description"
      content="Equipment Register"
    />
    <title>Equipment Register</title>

    <!-- Preconnect to external domains for faster loading -->
    <link rel="preconnect" href="https://www.carlstahl.com" />
    <link rel="preconnect" href="https://script.google.com" />

    <!-- Favicon with multiple sizes for better mobile support -->
    <link
      rel="icon"
      type="image/x-icon"
      href="https://www.carlstahl.com/images/favicon.ico"
    />
    <link
      rel="apple-touch-icon"
      href="https://www.carlstahl.com/images/favicon.ico"
    />

    <style>
      /* Reset and base styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body,
      html {
        height: 100%;
        width: 100%;
        overflow: hidden;
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu,
          Cantarell, sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      body {
        display: flex;
        flex-direction: column;
        background: #f5f5f5;
      }

      /* Logo container - hidden by default, can be shown if needed */
      .logo-container {
        display: none; /* Hidden to maximize iframe space on mobile */
        text-align: center;
        padding: 8px;
        background: #fff;
        border-bottom: 1px solid #e0e0e0;
        flex-shrink: 0;
      }

      .logo-container img {
        height: 50px;
        width: auto;
        max-width: 100%;
        object-fit: contain;
      }

      /* Iframe container */
      .iframe-container {
        flex: 1;
        position: relative;
        width: 100%;
        overflow: hidden;
      }

      iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: none;
        display: block;
      }

      /* Loading indicator */
      .loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        color: #666;
        z-index: 1;
      }

      .loading-spinner {
        border: 3px solid #f3f3f3;
        border-top: 3px solid #3498db;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 0 auto 10px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Mobile optimizations */
      @media screen and (max-width: 768px) {
        .logo-container {
          padding: 6px;
        }

        .logo-container img {
          height: 40px;
        }

        /* Ensure full viewport usage on mobile */
        body {
          position: fixed;
          width: 100vw;
          height: 100vh;
        }
      }

      /* Prevent pull-to-refresh on mobile */
      body {
        overscroll-behavior: none;
        touch-action: pan-x pan-y;
      }

      /* Hide loading once iframe loads */
      .iframe-loaded .loading {
        display: none;
      }
    </style>
  </head>
  <body>
    <!-- Optional: Uncomment to show logo -->
    <!-- <div class="logo-container">
      <img src="https://www.carlstahl.com/images/favicon.ico" alt="Company Logo" loading="lazy">
    </div> -->

    <div class="iframe-container">
      <div class="loading">
        <div class="loading-spinner"></div>
        <p>Loading...</p>
      </div>

      <iframe
        id="mainFrame"
        src="https://script.google.com/macros/s/AKfycbw0-KMA2uHMqw-Z8aU6UMPGAN76koHfWhZLFtMZQBV14MHLiSwnFavVb7il1Lsvqs02QA/exec"
        loading="eager"
        allow="camera; microphone; geolocation"
        title="CoC Certificate Application Form"
      >
        <p>
          Your browser doesn't support iframes. Please
          <a
            href="https://script.google.com/macros/s/AKfycbw0-KMA2uHMqw-Z8aU6UMPGAN76koHfWhZLFtMZQBV14MHLiSwnFavVb7il1Lsvqs02QA/exec"
            >click here</a
          >
          to access the form.
        </p>
      </iframe>
    </div>

    <script>
      // Mobile-optimized script
      (function () {
        "use strict";

        const iframe = document.getElementById("mainFrame");
        const container = document.querySelector(".iframe-container");

        // Remove loading indicator when iframe loads
        iframe.addEventListener("load", function () {
          container.classList.add("iframe-loaded");
        });

        // Handle orientation changes
        window.addEventListener("orientationchange", function () {
          // Force layout recalculation on orientation change
          setTimeout(function () {
            iframe.style.height = "99.9%";
            setTimeout(function () {
              iframe.style.height = "100%";
            }, 50);
          }, 100);
        });

        // Optional: Fullscreen functionality (not recommended for mobile)
        // Only attempt fullscreen on user interaction, not automatically
        function attemptFullscreen() {
          if (iframe.requestFullscreen) {
            iframe.requestFullscreen().catch(function (err) {
              console.log("Fullscreen not available:", err.message);
            });
          } else if (iframe.webkitRequestFullscreen) {
            iframe.webkitRequestFullscreen();
          } else if (iframe.mozRequestFullScreen) {
            iframe.mozRequestFullScreen();
          } else if (iframe.msRequestFullscreen) {
            iframe.msRequestFullscreen();
          }
        }

        // Uncomment to enable fullscreen button
        // document.addEventListener('dblclick', attemptFullscreen);

        // Prevent zoom on double tap for iOS
        let lastTouchEnd = 0;
        document.addEventListener(
          "touchend",
          function (event) {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) {
              event.preventDefault();
            }
            lastTouchEnd = now;
          },
          false,
        );

        // Service Worker for offline capability (optional)
        if ("serviceWorker" in navigator) {
          window.addEventListener("load", function () {
            // Uncomment when you have a service worker file
            // navigator.serviceWorker.register('/sw.js');
          });
        }
      })();
    </script>
  </body>
</html>
